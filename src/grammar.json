{
  "name": "tup",
  "rules": {
    "tupfile": {
      "type": "REPEAT",
      "content": {
        "type": "SYMBOL",
        "name": "_definition"
      }
    },
    "_definition": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SEQ",
          "members": [
            {
              "type": "SYMBOL",
              "name": "gitignore"
            },
            {
              "type": "STRING",
              "value": "\n"
            }
          ]
        },
        {
          "type": "SYMBOL",
          "name": "rule"
        },
        {
          "type": "SYMBOL",
          "name": "variable_statement"
        }
      ]
    },
    "rule": {
      "type": "SEQ",
      "members": [
        {
          "type": "TOKEN",
          "content": {
            "type": "STRING",
            "value": ": "
          }
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "input_statement"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "FIELD",
              "name": "order_only_inputs",
              "content": {
                "type": "SYMBOL",
                "name": "piped_files"
              }
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "SYMBOL",
          "name": "arrow"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "text"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "REPEAT1",
          "content": {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "command"
              },
              {
                "type": "SYMBOL",
                "name": "array_percent_flag"
              },
              {
                "type": "SYMBOL",
                "name": "percent_flag"
              },
              {
                "type": "SYMBOL",
                "name": "variable_reference"
              }
            ]
          }
        },
        {
          "type": "SYMBOL",
          "name": "arrow"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "FIELD",
              "name": "outputs",
              "content": {
                "type": "SYMBOL",
                "name": "files"
              }
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "FIELD",
              "name": "extra_outputs",
              "content": {
                "type": "SYMBOL",
                "name": "piped_files"
              }
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "group"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "bin"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": "\n"
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "foreach": {
      "type": "TOKEN",
      "content": {
        "type": "PREC",
        "value": 1,
        "content": {
          "type": "STRING",
          "value": "foreach"
        }
      }
    },
    "gitignore": {
      "type": "TOKEN",
      "content": {
        "type": "PREC",
        "value": 1,
        "content": {
          "type": "STRING",
          "value": ".gitignore"
        }
      }
    },
    "input_statement": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SEQ",
          "members": [
            {
              "type": "SYMBOL",
              "name": "foreach"
            },
            {
              "type": "FIELD",
              "name": "inputs",
              "content": {
                "type": "SYMBOL",
                "name": "files"
              }
            }
          ]
        },
        {
          "type": "FIELD",
          "name": "inputs",
          "content": {
            "type": "SYMBOL",
            "name": "files"
          }
        }
      ]
    },
    "arrow": {
      "type": "TOKEN",
      "content": {
        "type": "STRING",
        "value": "|>"
      }
    },
    "files": {
      "type": "REPEAT1",
      "content": {
        "type": "SYMBOL",
        "name": "filename"
      }
    },
    "piped_files": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "|"
        },
        {
          "type": "SYMBOL",
          "name": "files"
        }
      ]
    },
    "comment": {
      "type": "TOKEN",
      "content": {
        "type": "PREC",
        "value": -1,
        "content": {
          "type": "PATTERN",
          "value": "#.*"
        }
      }
    },
    "group": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "<"
        },
        {
          "type": "PATTERN",
          "value": "[^\\s>]+"
        },
        {
          "type": "STRING",
          "value": ">"
        }
      ]
    },
    "bin": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "{"
        },
        {
          "type": "PATTERN",
          "value": "[^\\s}]+"
        },
        {
          "type": "PREC_RIGHT",
          "value": 1,
          "content": {
            "type": "STRING",
            "value": "}"
          }
        }
      ]
    },
    "percent_flag": {
      "type": "CHOICE",
      "members": [
        {
          "type": "PATTERN",
          "value": "%[%eOdg]"
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "TOKEN",
              "content": {
                "type": "STRING",
                "value": "%"
              }
            },
            {
              "type": "SYMBOL",
              "name": "group"
            }
          ]
        }
      ]
    },
    "array_percent_flag": {
      "type": "PATTERN",
      "value": "%[0-9]*[bBofi]"
    },
    "filename": {
      "type": "CHOICE",
      "members": [
        {
          "type": "PREC_LEFT",
          "value": 0,
          "content": {
            "type": "SYMBOL",
            "name": "percent_flag"
          }
        },
        {
          "type": "SYMBOL",
          "name": "array_percent_flag"
        },
        {
          "type": "PATTERN",
          "value": "[^/<>{}%|\\\\\\s]+"
        }
      ]
    },
    "flag": {
      "type": "PREC",
      "value": 1,
      "content": {
        "type": "TOKEN",
        "content": {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": "b"
            },
            {
              "type": "STRING",
              "value": "c"
            },
            {
              "type": "STRING",
              "value": "j"
            },
            {
              "type": "STRING",
              "value": "o"
            },
            {
              "type": "STRING",
              "value": "s"
            },
            {
              "type": "STRING",
              "value": "t"
            }
          ]
        }
      }
    },
    "text": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "^"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "flag"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "percent_flag"
                },
                {
                  "type": "SYMBOL",
                  "name": "array_percent_flag"
                },
                {
                  "type": "PATTERN",
                  "value": " [^^]*"
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "^"
        }
      ]
    },
    "identifier": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SYMBOL",
          "name": "tup_identifier"
        },
        {
          "type": "SYMBOL",
          "name": "reference"
        },
        {
          "type": "SYMBOL",
          "name": "normal"
        }
      ]
    },
    "tup_identifier": {
      "type": "PREC",
      "value": 2,
      "content": {
        "type": "PATTERN",
        "value": "TUP_[\\w\\d]*"
      }
    },
    "reference": {
      "type": "PREC",
      "value": 1,
      "content": {
        "type": "PATTERN",
        "value": "&[\\w\\d]+"
      }
    },
    "normal": {
      "type": "PATTERN",
      "value": "[\\w\\d]+"
    },
    "operators": {
      "type": "CHOICE",
      "members": [
        {
          "type": "STRING",
          "value": "="
        },
        {
          "type": "STRING",
          "value": "+="
        },
        {
          "type": "STRING",
          "value": ":="
        }
      ]
    },
    "variable_statement": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "identifier"
        },
        {
          "type": "SYMBOL",
          "name": "operators"
        },
        {
          "type": "PATTERN",
          "value": "[^\\n]+"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "STRING",
              "value": "\n"
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "variable_reference": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "TOKEN",
              "content": {
                "type": "STRING",
                "value": "$("
              }
            },
            {
              "type": "TOKEN",
              "content": {
                "type": "STRING",
                "value": "@("
              }
            },
            {
              "type": "TOKEN",
              "content": {
                "type": "STRING",
                "value": "&("
              }
            }
          ]
        },
        {
          "type": "REPEAT1",
          "content": {
            "type": "CHOICE",
            "members": [
              {
                "type": "SYMBOL",
                "name": "tup_identifier"
              },
              {
                "type": "SYMBOL",
                "name": "normal"
              },
              {
                "type": "SYMBOL",
                "name": "percent_flag"
              },
              {
                "type": "SYMBOL",
                "name": "array_percent_flag"
              }
            ]
          }
        },
        {
          "type": "STRING",
          "value": ")"
        }
      ]
    }
  },
  "extras": [
    {
      "type": "SYMBOL",
      "name": "comment"
    },
    {
      "type": "PATTERN",
      "value": "[\\s]"
    },
    {
      "type": "ALIAS",
      "content": {
        "type": "TOKEN",
        "content": {
          "type": "SEQ",
          "members": [
            {
              "type": "STRING",
              "value": "\\"
            },
            {
              "type": "PATTERN",
              "value": "\\r?\\n|\\r"
            }
          ]
        }
      },
      "named": false,
      "value": "\\"
    }
  ],
  "conflicts": [],
  "precedences": [],
  "externals": [
    {
      "type": "SYMBOL",
      "name": "command"
    }
  ],
  "inline": [
    "_definition"
  ],
  "supertypes": []
}
